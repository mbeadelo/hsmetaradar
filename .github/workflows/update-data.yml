name: Update HS Meta Data
on:
	schedule:
		- cron: '*/30 * * * *'
	workflow_dispatch:
permissions:
	contents: write
jobs:
	scrape:
		runs-on: ubuntu-latest
		timeout-minutes: 20
		steps:
			- name: Checkout repository
				uses: actions/checkout@v4
			- name: Setup Node.js
				uses: actions/setup-node@v4
				with:
					node-version: '20'
			- name: Install dependencies
				run: |
					npm install
					npm install playwright
			- name: Install Playwright browsers
				run: npx playwright install --with-deps chromium
			- name: Run scraper
				run: npm run scrape
			- name: Commit and push if changes
				run: |
					git config --local user.email "github-actions[bot]@users.noreply.github.com"
					git config --local user.name "github-actions[bot]"
					git add top_decks.json historical_data.json package.json package-lock.json
					git diff --quiet && git diff --staged --quiet || (git commit -m "ðŸ”„ Auto-update [$(date +'%Y-%m-%d %H:%M UTC')]" && git push)
